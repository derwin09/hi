copilotedai@raspberrypi:~/Desktop/mshop-fridge-10-fps $ python3 run.py
ğŸš€ Starting MShop Fridge Camera Application...
ğŸ“¦ Checking dependencies...
Checking dependencies...
âœ… All dependencies are already installed.
ğŸ¥ Starting camera application...
âœ… Using rpi-lgpio library (Pi 5 compatible RPi.GPIO replacement)
ğŸš€ Creating GPIO Controller V2...
ğŸ” GPIO Controller V2 System Information:
   Platform: Linux-6.12.47+rpt-rpi-v8-aarch64-with-glibc2.41
   Python: 3.13.5
   Architecture: aarch64
   GPIO Library: rpi-lgpio
   Use GPIO: True
   Test Mode: False
   Transaction Pin: GPIO 26
   Alarm Pin: GPIO 19
   Light1 Pin: GPIO 12
ğŸ”§ Initializing GPIO Controller V2...
   Setting up GPIO using rpi-lgpio...
   âœ… GPIO.setmode(GPIO.BCM) successful
âœ… GPIO Controller V2 initialized successfully
ğŸ§ª Running startup test...
ğŸ§ª TESTING PIN 26 COMPREHENSIVE TEST
==================================================
Step 1: Setting up PIN 26 as output
ğŸ”§ Setting up GPIO pin 26 as output
   âœ… Pin 26 configured as OUTPUT (initialized LOW)
âœ… Pin 26 successfully configured as output
Step 2: Setting PIN 26 to HIGH
Step 3: Reading PIN 26 after HIGH
   Pin state after HIGH: True (HIGH)
Step 4: Setting PIN 26 to LOW
Step 5: Reading PIN 26 after LOW
   Pin state after LOW: False (LOW)
âœ… PIN 26 TEST PASSED
==================================================
âœ… GPIO Controller V2 startup test PASSED
ğŸ”§ Initializing alarm pin (GPIO 19)...
ğŸ”§ Setting up GPIO pin 19 as output
   âœ… Pin 19 configured as OUTPUT (initialized LOW)
âœ… Pin 19 successfully configured as output
âœ… Alarm pin initialized successfully (OFF)
ğŸ”§ Initializing Light 1 pin (GPIO 12)...
ğŸ”§ Setting up GPIO pin 12 as output
   âœ… Pin 12 configured as OUTPUT (initialized LOW)
âœ… Pin 12 successfully configured as output
âœ… Light 1 pin initialized successfully (OFF)
2025-12-19 15:36:02,348 - camera_app - INFO - Starting Camera Start Application
ğŸ”„ INIT: Transaction Processor Initialized
âŒ¨ï¸  Press 'W' key to toggle alarm
ğŸ”§ Setting up GPIO pin 13 as input
   âœ… Pin 13 configured as INPUT
âœ… Pin 13 successfully configured as input
Found video devices: ['/dev/video0', '/dev/video2', '/dev/video3', '/dev/video4']
Camera 0 opened with FPS set to 30.0, actual FPS: 10.0
Found camera at index 0 (Resolution: 1280x720, FPS: 10.0)
No device at /dev/video1
Camera 2 opened with FPS set to 30.0, actual FPS: 10.0
Found camera at index 2 (Resolution: 1280x720, FPS: 10.0)
[ WARN:0@3.359] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video3): can't open camera by index
[ WARN:0@3.359] global cap.cpp:342 open VIDEOIO(V4L2): backend is generally available but can't be used to capture by index
[ WARN:0@3.493] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src0 reported: Device '/dev/video3' is not a capture device.
[ WARN:0@3.493] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@3.493] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@3.493] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video3): can't open camera by index
[ERROR:0@3.601] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
[ WARN:0@3.610] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src1 reported: Device '/dev/video3' is not a capture device.
[ WARN:0@3.610] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@3.610] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@3.610] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video3): can't open camera by index
[ERROR:0@3.714] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
Could not open camera at index 3 (/dev/video3)
[ WARN:0@3.717] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video4): can't open camera by index
[ WARN:0@3.717] global cap.cpp:342 open VIDEOIO(V4L2): backend is generally available but can't be used to capture by index
[ WARN:0@3.723] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src2 reported: Device '/dev/video4' is not a capture device.
[ WARN:0@3.723] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@3.723] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@3.723] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video4): can't open camera by index
[ERROR:0@3.813] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
[ WARN:0@3.819] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src3 reported: Device '/dev/video4' is not a capture device.
[ WARN:0@3.819] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@3.819] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@3.819] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video4): can't open camera by index
[ERROR:0@3.909] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
Could not open camera at index 4 (/dev/video4)
Total valid cameras found: 2
ğŸ”” Startup beep - system initialized successfully
Camera 2 (preview 0): Hardware FPS set to 72.0 (target recording: 60 FPS), actual: 10.0
Starting camera loop for preview 0
Camera 2 started successfully on attempt 1
[ WARN:0@6.417] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video1): can't open camera by index
[ WARN:0@6.417] global cap.cpp:342 open VIDEOIO(V4L2): backend is generally available but can't be used to capture by index
[ WARN:0@6.423] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src4 reported: Cannot identify device '/dev/video1'.
[ WARN:0@6.423] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@6.423] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@6.423] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video1): can't open camera by index
[ERROR:0@6.637] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
[ WARN:0@6.645] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src5 reported: Cannot identify device '/dev/video1'.
[ WARN:0@6.645] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@6.645] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@6.645] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video1): can't open camera by index
[ERROR:0@6.757] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
Camera 1 attempt 1 failed: Could not open camera 1
Retrying camera 1 in 3 seconds...
[ WARN:0@9.757] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video1): can't open camera by index
[ WARN:0@9.757] global cap.cpp:342 open VIDEOIO(V4L2): backend is generally available but can't be used to capture by index
[ WARN:0@9.763] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src6 reported: Cannot identify device '/dev/video1'.
[ WARN:0@9.763] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@9.763] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@9.763] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video1): can't open camera by index
[ERROR:0@9.961] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
[ WARN:0@9.968] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src7 reported: Cannot identify device '/dev/video1'.
[ WARN:0@9.968] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@9.968] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@9.968] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video1): can't open camera by index
[ERROR:0@10.061] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
Camera 1 attempt 2 failed: Could not open camera 1
Retrying camera 1 in 10 seconds...
[ WARN:0@20.061] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video1): can't open camera by index
[ WARN:0@20.061] global cap.cpp:342 open VIDEOIO(V4L2): backend is generally available but can't be used to capture by index
[ WARN:0@20.069] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src8 reported: Cannot identify device '/dev/video1'.
[ WARN:0@20.069] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@20.069] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@20.069] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video1): can't open camera by index
[ERROR:0@20.289] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
[ WARN:0@20.298] global cap_gstreamer.cpp:2839 handleMessage OpenCV | GStreamer warning: Embedded video playback halted; module v4l2src9 reported: Cannot identify device '/dev/video1'.
[ WARN:0@20.299] global cap_gstreamer.cpp:1698 open OpenCV | GStreamer warning: unable to start pipeline
[ WARN:0@20.299] global cap_gstreamer.cpp:1173 isPipelinePlaying OpenCV | GStreamer warning: GStreamer: pipeline have not been created
[ WARN:0@20.299] global cap_v4l.cpp:999 open VIDEOIO(V4L2:/dev/video1): can't open camera by index
[ERROR:0@20.397] global obsensor_uvc_stream_channel.cpp:158 getStreamChannelGroup Camera index out of range
Camera 1 attempt 3 failed: Could not open camera 1
Could not auto-start camera 1: Failed to start camera 1 after 3 attempts: Could not open camera 1
Camera 0 (preview 1): Hardware FPS set to 72.0 (target recording: 60 FPS), actual: 10.0
Starting camera loop for preview 1
Camera 0 started successfully on attempt 1
Camera 0 failed to read frame
ğŸš¨ Preview 0: cap.read() returned False
Camera loop ended for preview 0
Camera 2 (preview 0): Hardware FPS set to 72.0 (target recording: 60 FPS), actual: 10.0
Starting camera loop for preview 0
Camera 2 started successfully on attempt 1
ğŸ”¥ Firebase Event: PUT
ğŸ“± Processed Event: MATCH | picking_status: cancelled | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ”¥ Firebase Event: PUT
ğŸ“± Processed Event: MATCH | picking_status: started | STAGE: idle
ğŸš€ Starting transaction with ID: [-OgpXat0eYt_0PD2Qbmf] from event: put
ğŸ”„ STAGE 2: TRANSACTION_STARTED - New transaction initiated - [-OgpXat0eYt_0PD2Qbmf]
ğŸ”„ STAGE 3: DOOR_UNLOCK - Energizing door lock - [-OgpXat0eYt_0PD2Qbmf]
ğŸ¥ Recording active for preview 0 (hardware cam 2): throttling to 60 fps (measured: not-measured-yet fps)
âš ï¸ Preview 0 FPS deviation 100.0% (actual 0.0 vs target 60)
ğŸ¥ Recording active for preview 1 (hardware cam 0): throttling to 60 fps (measured: not-measured-yet fps)
âš ï¸ Preview 1 FPS deviation 100.0% (actual 0.0 vs target 60)
ğŸ”¥ Firebase Event: PATCH
ğŸ”¥ Firebase Event: PATCH
âš ï¸ Camera 0 recording FPS deviation 94.8% (actual 3.1 vs target 60)
âš ï¸ Preview 0 FPS deviation 94.9% (actual 3.1 vs target 60)
âš ï¸ Camera 1 recording FPS deviation 88.3% (actual 7.0 vs target 60)
âš ï¸ Preview 1 FPS deviation 88.2% (actual 7.1 vs target 60)
ğŸ”„ SENSOR: Door OPENED detected
ğŸ”„ STAGE 4: DOOR_OPEN - Door opened, waiting 400ms then disengaging lock - [-OgpXat0eYt_0PD2Qbmf]
ğŸ”„ FIREBASE: Updating record [-OgpXat0eYt_0PD2Qbmf] to picking_status='picking'
ğŸ”„ FIREBASE: âœ… Successfully updated record [-OgpXat0eYt_0PD2Qbmf] to picking
ğŸ”¥ Firebase Event: PATCH
ğŸ”„ LOCK: Door lock DISENGAGED after 400ms delay
âš ï¸ Camera 0 recording FPS deviation 94.9% (actual 3.1 vs target 60)
âš ï¸ Preview 0 FPS deviation 95.0% (actual 3.0 vs target 60)
âš ï¸ Camera 1 recording FPS deviation 89.4% (actual 6.4 vs target 60)
âš ï¸ Preview 1 FPS deviation 90.7% (actual 5.6 vs target 60)
âš ï¸ Camera 1 recording FPS deviation 90.0% (actual 6.0 vs target 60)
âš ï¸ Preview 1 FPS deviation 91.5% (actual 5.1 vs target 60)
âš ï¸ Camera 0 recording FPS deviation 95.7% (actual 2.6 vs target 60)
âš ï¸ Preview 0 FPS deviation 96.8% (actual 1.9 vs target 60)
ğŸ”„ SENSOR: Door CLOSED detected
ğŸ”„ STAGE 5: DOOR_CLOSED - Door closed, transaction phase complete - [-OgpXat0eYt_0PD2Qbmf]
ğŸ”„ STAGE 6: TRANSACTION_COMPLETE - Transaction completed, updating Firebase - [-OgpXat0eYt_0PD2Qbmf]
ğŸ”„ FIREBASE: Updating record [-OgpXat0eYt_0PD2Qbmf] to picking_status='completed'
ğŸ”¥ Firebase Event: PATCH
ğŸ“± Processed Event: PATCH | picking_status: picking | STAGE: transmission_complete
ğŸ”„ FIREBASE: âœ… Successfully updated record [-OgpXat0eYt_0PD2Qbmf] to completed
ğŸ”„ STAGE 1: IDLE - Transaction completed, returning to idle state
ğŸ”¥ Firebase Event: PATCH
ğŸ“± Processed Event: PATCH | picking_status: completed | STAGE: idle
ğŸ”¥ Firebase Event: PUT
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ”¥ Firebase Event: PUT
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ”¥ Firebase Event: PUT
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ”¥ Firebase Event: PATCH
âš ï¸ video3_filename not set in Firebase
âŒ video3_filename: Filename does not match actual file
ğŸ”¥ Firebase Event: PUT
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ”¥ Firebase Event: PUT
ğŸ“± Processed Event: MATCH | picking_status: completed | STAGE: idle
ğŸ”¥ Firebase Event: PATCH
ğŸ”¥ Firebase Event: PATCH

